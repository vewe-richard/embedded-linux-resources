<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第3讲(续):grep与管道的智慧 - 讨论课</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #333;
            line-height: 1.8;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .class-mode {
            background: #e17055;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
        }

        .content {
            padding: 40px;
        }

        /* 讨论区块样式 */
        .discussion-block {
            background: linear-gradient(135deg, #dfe6e9 0%, #b2bec3 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border-left: 6px solid #0984e3;
        }

        .discussion-block h3 {
            color: #0984e3;
            font-size: 1.4em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .discussion-block h3::before {
            content: '?';
            background: #0984e3;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .discussion-prompt {
            font-size: 1.15em;
            color: #2d3436;
            margin: 15px 0;
        }

        .think-points {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .think-points h4 {
            color: #636e72;
            margin-bottom: 10px;
        }

        .think-points ul {
            margin-left: 20px;
            color: #555;
        }

        .think-points li {
            margin: 8px 0;
        }

        /* 场景卡片 */
        .scenario-card {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            position: relative;
        }

        .scenario-card::before {
            content: '场景';
            position: absolute;
            top: -12px;
            left: 20px;
            background: #e17055;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .scenario-card h4 {
            color: #2d3436;
            margin-bottom: 15px;
            padding-top: 10px;
        }

        /* 命令展示 */
        .command-box {
            background: #2d3436;
            color: #00cec9;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        .command-box .comment {
            color: #636e72;
        }

        .command-box .highlight {
            color: #ffeaa7;
        }

        /* 对比讨论 */
        .versus-box {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin: 25px 0;
        }

        .versus-option {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .versus-option h4 {
            color: #0984e3;
            margin-bottom: 10px;
        }

        .versus-vs {
            font-size: 2em;
            color: #e17055;
            font-weight: bold;
        }

        /* 动手环节 */
        .hands-on {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .hands-on h3 {
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        /* 开放问题 */
        .open-question {
            background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }

        .open-question h3 {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .open-question p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        /* 时间标签 */
        .time-marker {
            background: #e17055;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin: 20px 0;
        }

        /* 分隔线 */
        .divider {
            height: 3px;
            background: linear-gradient(90deg, transparent, #dfe6e9, transparent);
            margin: 40px 0;
        }

        /* 小贴士 */
        .tip-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .tip-box strong {
            color: #856404;
        }

        /* 真实案例 */
        .real-case {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }

        .real-case h4 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        /* 辩论区 */
        .debate-zone {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .debate-zone h3 {
            margin-bottom: 20px;
        }

        .debate-sides {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .debate-side {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 10px;
        }

        .debate-side h4 {
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        footer {
            background: #2d3436;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .student-names {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 15px;
        }

        .student-tag {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 15px;
        }

        /* 总结盒子 */
        .takeaway-box {
            background: #2d3436;
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .takeaway-box h3 {
            margin-bottom: 20px;
            color: #00cec9;
        }

        .takeaway-list {
            list-style: none;
        }

        .takeaway-list li {
            padding: 10px 0;
            border-bottom: 1px solid #444;
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }

        .takeaway-list li:last-child {
            border-bottom: none;
        }

        .takeaway-list .icon {
            font-size: 1.2em;
        }

        /* 响应式 */
        @media (max-width: 768px) {
            .versus-box {
                grid-template-columns: 1fr;
            }
            .versus-vs {
                transform: rotate(90deg);
            }
            .debate-sides {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>grep 与管道的智慧</h1>
            <p class="subtitle">第3讲（续）- 从"会用"到"理解"</p>
            <div class="class-mode">讨论课 | 30分钟</div>
        </header>

        <div class="content">
            <!-- 开场 -->
            <div class="time-marker">Part 1: 热身讨论 (5分钟)</div>

            <div class="open-question">
                <h3>开场问题</h3>
                <p>"你们平时怎么在微信聊天记录里找东西？"</p>
            </div>

            <div class="discussion-block">
                <h3>为什么需要"搜索"？</h3>
                <p class="discussion-prompt">
                    假设你有一个 10000 行的日志文件，里面记录了服务器一天的运行状态。
                    现在用户投诉"下午3点左右系统卡了"，你怎么找原因？
                </p>
                <div class="think-points">
                    <h4>讨论要点：</h4>
                    <ul>
                        <li>用眼睛从头看到尾？—— 人不是机器</li>
                        <li>Ctrl+F？—— 你知道要搜什么词吗？</li>
                        <li>按时间过滤？—— 怎么表达"下午3点左右"？</li>
                        <li>组合条件？—— "3点" + "error" + "timeout"？</li>
                    </ul>
                </div>
            </div>

            <div class="divider"></div>

            <!-- grep 深入 -->
            <div class="time-marker">Part 2: grep 的思维方式 (10分钟)</div>

            <div class="scenario-card">
                <h4>场景：你是值班运维</h4>
                <p>凌晨2点，手机响了。客户说网站打不开了。</p>
                <p>你 SSH 登录服务器，面对这个日志文件：<code>/var/log/nginx/error.log</code></p>
                <p style="margin-top: 15px;"><strong>你的第一个命令会是什么？为什么？</strong></p>
            </div>

            <div class="discussion-block">
                <h3>grep 不只是"搜索"</h3>
                <p class="discussion-prompt">
                    grep 真正做的事情是什么？
                </p>
                <div class="command-box">
grep "error" app.log
<span class="comment"># 这条命令背后发生了什么？</span>
                </div>
                <div class="think-points">
                    <h4>一起拆解：</h4>
                    <ul>
                        <li><strong>读取</strong>：把文件一行一行读进来</li>
                        <li><strong>匹配</strong>：每行检查是否包含 "error"</li>
                        <li><strong>输出</strong>：匹配的行打印出来，不匹配的扔掉</li>
                        <li><strong>本质</strong>：它是一个"过滤器"！</li>
                    </ul>
                </div>
            </div>

            <div class="versus-box">
                <div class="versus-option">
                    <h4>方式 A</h4>
                    <div class="command-box" style="text-align: left; font-size: 0.9em;">
grep "error" log.txt
                    </div>
                    <p>直接搜文件</p>
                </div>
                <div class="versus-vs">VS</div>
                <div class="versus-option">
                    <h4>方式 B</h4>
                    <div class="command-box" style="text-align: left; font-size: 0.9em;">
cat log.txt | grep "error"
                    </div>
                    <p>用管道传入</p>
                </div>
            </div>

            <div class="debate-zone">
                <h3>小辩论：这两种写法有区别吗？哪个更好？</h3>
                <div class="debate-sides">
                    <div class="debate-side">
                        <h4>支持方式 A 的理由</h4>
                        <ul>
                            <li>更简洁，少打字</li>
                            <li>少一个进程，理论上更快</li>
                            <li>"能用一个命令就不用两个"</li>
                        </ul>
                    </div>
                    <div class="debate-side">
                        <h4>支持方式 B 的理由</h4>
                        <ul>
                            <li>更一致的思维模式</li>
                            <li>方便继续接管道</li>
                            <li>"数据流"的概念更清晰</li>
                        </ul>
                    </div>
                </div>
                <p style="margin-top: 20px; text-align: center; opacity: 0.9;">
                    <strong>讲师引导：</strong>其实两种都对，但在不同场景各有优势...
                </p>
            </div>

            <div class="hands-on">
                <h3>动手实验：参数的威力</h3>
                <p>大家一起在终端试试这些命令的区别：</p>
                <div class="command-box" style="background: rgba(0,0,0,0.3);">
<span class="comment"># 准备一个测试文件</span>
echo -e "Error: file not found\nerror: connection refused\nERROR: timeout\nAll good\ndebug: error simulation" > test.log

<span class="comment"># 然后依次运行，观察输出：</span>
grep "error" test.log        <span class="comment"># 基础搜索</span>
grep -i "error" test.log     <span class="comment"># 加 -i 呢？</span>
grep -n "error" test.log     <span class="comment"># 加 -n 呢？</span>
grep -v "error" test.log     <span class="comment"># 加 -v 呢？（重要！）</span>
grep -c "error" test.log     <span class="comment"># 加 -c 呢？</span>
                </div>
                <p style="margin-top: 15px;">
                    <strong>讨论：-v（反向匹配）在什么场景下特别有用？</strong>
                </p>
            </div>

            <div class="discussion-block">
                <h3>一个真实的问题</h3>
                <p class="discussion-prompt">
                    "我想找所有包含 error 但不包含 debug 的行，怎么做？"
                </p>
                <div class="think-points">
                    <h4>思路讨论：</h4>
                    <ul>
                        <li>grep 能同时指定"要"和"不要"吗？</li>
                        <li>如果不能，有没有办法组合？</li>
                        <li>提示：管道可以串联多个 grep...</li>
                    </ul>
                </div>
                <div class="command-box">
<span class="comment"># 大家一起想出来的答案：</span>
grep "error" log.txt | grep -v "debug"
<span class="comment"># 先过滤出 error，再从结果中排除 debug</span>
                </div>
            </div>

            <div class="divider"></div>

            <!-- 管道哲学 -->
            <div class="time-marker">Part 3: 管道思维 (10分钟)</div>

            <div class="open-question">
                <h3>核心问题</h3>
                <p>"为什么 Linux 要设计成一堆小工具 + 管道，<br>而不是一个超级大工具什么都能做？"</p>
            </div>

            <div class="real-case">
                <h4>真实案例讨论</h4>
                <p>你的老板问："咱们网站今天被访问了多少次？访问最多的是哪个页面？"</p>
                <p style="margin-top: 15px;">你只有一个 access.log，每行格式大概是：</p>
                <div class="command-box" style="background: rgba(0,0,0,0.3);">
192.168.1.1 - - [10/Jan/2024:10:23:45] "GET /index.html HTTP/1.1" 200 1234
192.168.1.2 - - [10/Jan/2024:10:23:46] "GET /about.html HTTP/1.1" 200 567
192.168.1.1 - - [10/Jan/2024:10:23:47] "GET /index.html HTTP/1.1" 200 1234
                </div>
                <p style="margin-top: 15px;"><strong>不准用 Excel，只用命令行，怎么回答老板？</strong></p>
            </div>

            <div class="discussion-block">
                <h3>一起拆解这个问题</h3>
                <p class="discussion-prompt">
                    "统计访问次数"这个需求，可以分解成哪些步骤？
                </p>
                <div class="think-points">
                    <h4>引导学生思考：</h4>
                    <ul>
                        <li>第一步：获取数据（读文件）</li>
                        <li>第二步：提取我们关心的部分（URL）</li>
                        <li>第三步：统计每个 URL 出现多少次</li>
                        <li>第四步：排序，找出最多的</li>
                    </ul>
                </div>
            </div>

            <div class="hands-on">
                <h3>一起拼命令</h3>
                <p>根据我们讨论的步骤，把命令拼出来：</p>
                <div class="command-box" style="background: rgba(0,0,0,0.3);">
<span class="comment"># 步骤1: 读取日志</span>
cat access.log

<span class="comment"># 步骤2: 提取 URL（第7列，用空格分隔）</span>
cat access.log | awk '{print $7}'
<span class="comment"># 或者用 cut: cat access.log | cut -d'"' -f2 | cut -d' ' -f2</span>

<span class="comment"># 步骤3: 排序（为了让相同的 URL 相邻）</span>
cat access.log | awk '{print $7}' | sort

<span class="comment"># 步骤4: 统计相邻相同行的数量</span>
cat access.log | awk '{print $7}' | sort | uniq -c

<span class="comment"># 步骤5: 按数量排序，最多的在前</span>
cat access.log | awk '{print $7}' | sort | uniq -c | sort -rn | head -10
                </div>
                <p style="margin-top: 15px;">
                    <strong>思考：如果没有管道，你需要写多少个临时文件？</strong>
                </p>
            </div>

            <div class="tip-box">
                <p><strong>讲师提示：</strong></p>
                <p>这里不用完全掌握 awk 和 cut，重点是理解"管道组合"的思想。每个小工具做一件事，通过管道串起来解决大问题。</p>
            </div>

            <div class="scenario-card">
                <h4>课堂小挑战</h4>
                <p>用今天学的命令组合，统计一下：</p>
                <p style="font-size: 1.2em; margin-top: 15px;"><strong>/etc/passwd 文件里有多少个用户使用 /bin/bash 作为默认shell？</strong></p>
                <div class="command-box">
<span class="comment"># 提示：/etc/passwd 的最后一列是 shell</span>
<span class="comment"># 每行格式：用户名:x:uid:gid:描述:home目录:shell</span>

<span class="comment"># 大家一起讨论怎么组合...</span>
                </div>
            </div>

            <div class="divider"></div>

            <!-- 总结讨论 -->
            <div class="time-marker">Part 4: 开放讨论 (5分钟)</div>

            <div class="open-question">
                <h3>思考题</h3>
                <p>"学会命令行，和只会用图形界面的人相比，有什么本质区别？"</p>
            </div>

            <div class="discussion-block">
                <h3>更深的问题</h3>
                <p class="discussion-prompt">
                    有人说："ChatGPT/AI时代，不用学命令了，让AI帮你写就行。"<br>
                    你们怎么看这个观点？
                </p>
                <div class="think-points">
                    <h4>可能的讨论方向：</h4>
                    <ul>
                        <li>AI 能帮你写，但你怎么知道它写的对不对？</li>
                        <li>理解原理 vs 只会用工具</li>
                        <li>当没有网络/AI不可用时呢？</li>
                        <li>面试的时候呢？</li>
                    </ul>
                </div>
            </div>

            <div class="takeaway-box">
                <h3>今日收获（一起总结）</h3>
                <ul class="takeaway-list">
                    <li>
                        <span class="icon">1.</span>
                        <span><strong>grep 是过滤器</strong>：读入 -> 匹配 -> 输出，不匹配的丢掉</span>
                    </li>
                    <li>
                        <span class="icon">2.</span>
                        <span><strong>-v 很有用</strong>：反向思维，有时候"排除什么"比"找什么"更高效</span>
                    </li>
                    <li>
                        <span class="icon">3.</span>
                        <span><strong>管道是组合</strong>：小工具 + 管道 = 解决大问题</span>
                    </li>
                    <li>
                        <span class="icon">4.</span>
                        <span><strong>分解问题</strong>：大需求拆成小步骤，一步步用管道串起来</span>
                    </li>
                </ul>
            </div>

            <div class="real-case" style="background: linear-gradient(135deg, #636e72 0%, #2d3436 100%);">
                <h4>课后小任务（可选）</h4>
                <p>在自己电脑上试试：</p>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>用 <code>history | grep "git"</code> 看看你最近用过哪些 git 命令</li>
                    <li>用 <code>ls -la | grep "^d"</code> 只显示目录（为什么这样写？）</li>
                    <li>用 <code>cat /etc/passwd | grep -c "/bin/bash"</code> 验证课堂答案</li>
                </ol>
            </div>

            <div class="open-question" style="background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);">
                <h3>下节课预告</h3>
                <p>权限管理 —— 为什么有些文件你看不了？sudo 又是什么鬼？</p>
            </div>
        </div>

        <footer>
            <p>海巴巴Linux培训班 | 讨论式学习</p>
            <div class="student-names">
                <span class="student-tag">王子臻</span>
                <span class="student-tag">钱辰宇</span>
                <span class="student-tag">钱姿妤</span>
            </div>
            <p style="margin-top: 15px; opacity: 0.7; font-size: 0.9em;">
                "学习不是填鸭，是点燃火焰"
            </p>
        </footer>
    </div>
</body>
</html>
